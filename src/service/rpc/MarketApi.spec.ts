import 'mocha';
import axios from 'axios';
import MockAdapter from 'axios-mock-adapter';
import { expect } from 'chai';
import { croMarketPriceApi } from './MarketApi';

describe('MarketApi', () => {
  let axiosMock: MockAdapter;

  beforeEach(() => {
    axiosMock = new MockAdapter(axios, { onNoMatch: 'throwException' });
  });

  afterEach(() => {
    axiosMock.reset();
  });
  it('should return the `ETH` fiat rate ', async () => {
    const ethToFiatRateStub = {
      "data": {
        "currency": "ETH",
        "rates": {
          "AED": "12589.911366",
          "AFN": "294527.77365831",
          "ALL": "353083.978571845",
          "AMD": "1688567.25495509",
          "ANG": "6147.57982301",
          "AOA": "2175159.795595",
          "ARS": "334658.143557475",
          "AUD": "4680.240939975",
          "AWG": "6171.2227525",
          "AZN": "5829.517641525",
          "BAM": "5660.47652243",
          "BBD": "6855.01",
          "BDT": "291880.95832717",
          "BGN": "5671.80099895",
          "BHD": "1292.10768991",
          "BIF": "6797514.0834757",
          "BMD": "3427.505",
          "BND": "4601.552280185",
          "BOB": "23648.45462806",
          "BRL": "17741.73929142",
          "BSD": "3427.505",
          "BTN": "249876.997659835",
          "BWP": "37882.927450625",
          "BYN": "8621.69003221",
          "BYR": "86216900.32210000685501",
          "BZD": "6903.13902521",
          "CAD": "4313.285399665",
          "CDF": "6801374.403524585",
          "CHF": "3124.407305345",
          "CLF": "96.94355142",
          "CLP": "2675030.5523",
          "CNY": "22145.795306",
          "COP": "13077691.86616289",
          "CRC": "2129666.75480034",
          "CUC": "3427.505",
          "CVE": "319568.80985785",
          "CZK": "73871.644263",
          "DJF": "609698.131472255",
          "DKK": "21530.88034397",
          "DOP": "194973.86185035",
          "DZD": "464112.54303138",
          "EGP": "53810.457498",
          "ERN": "51429.393767035",
          "ETB": "156450.731305805",
          "EUR": "2896.195",
          "FJD": "7179.76609875",
          "FKP": "2486.898230355",
          "GBP": "2486.76",
          "GEL": "10655.026525915",
          "GHS": "20702.4729505",
          "GIP": "2486.898230355",
          "GMD": "175419.7059",
          "GNF": "33527995.00667083",
          "GTQ": "26499.33675189",
          "GYD": "716083.89362893",
          "HKD": "26671.30153275",
          "HNL": "81769.95936496",
          "HRK": "21687.195137",
          "HTG": "334972.034465375",
          "HUF": "1009485.95811007",
          "IDR": "48923178.1185",
          "ILS": "10988.25198952",
          "INR": "250185.5862175",
          "IQD": "4996822.346757365",
          "ISK": "433133.80685",
          "JMD": "518657.394888205",
          "JOD": "2430.101045",
          "JPY": "376208.0900575",
          "KES": "376374.32405",
          "KGS": "290297.99941797",
          "KHR": "13950258.181808855",
          "KMF": "1436123.700421195",
          "KRW": "3967987.684201655",
          "KWD": "1030.7193036",
          "KYD": "2853.82977813",
          "KZT": "1460695.4186436",
          "LAK": "32823182.97736015",
          "LBP": "5178341.736525505",
          "LKR": "683212.643424275",
          "LRD": "589016.76167004",
          "LSL": "49812.756193705",
          "LYD": "15477.36496818",
          "MAD": "30619.58849746",
          "MDL": "60376.42600135",
          "MGA": "13421501.633155635",
          "MKD": "178273.072964955",
          "MMK": "5636942.214000955",
          "MNT": "9744827.11365786",
          "MOP": "27447.82335553",
          "MRO": "1223618.69546914",
          "MUR": "146011.716427505",
          "MVR": "52954.606071995",
          "MWK": "2782641.318453695",
          "MXN": "68948.82165665",
          "MYR": "14248.138285",
          "MZN": "218417.756125",
          "NAD": "51138.3746",
          "NGN": "1412132.06",
          "NIO": "120260.850797475",
          "NOK": "29725.27703785",
          "NPR": "399779.367555475",
          "NZD": "4856.01367889",
          "OMR": "1319.661402605",
          "PAB": "3427.505",
          "PEN": "13985.08413126",
          "PGK": "12024.520423715",
          "PHP": "170062.515585",
          "PKR": "571484.473781665",
          "PLN": "13114.38132609",
          "PYG": "23698451.68462506",
          "QAR": "12642.85946324",
          "RON": "14293.124288125",
          "RSD": "340294.771500115",
          "RUB": "251318.7193705",
          "RWF": "3455741.01240533",
          "SAR": "12855.15226793",
          "SBD": "27630.24202664",
          "SCR": "43862.429283445",
          "SEK": "29420.4690182",
          "SHP": "2486.898230355",
          "SLL": "35362768.228471795",
          "SOS": "1981274.20771221",
          "SRD": "72988.718975",
          "SSP": "446466.8013",
          "STD": "71113155.69141252",
          "SVC": "29966.08668414",
          "SZL": "49773.11024337",
          "THB": "110441.97782633",
          "TJS": "39013.880710445",
          "TMT": "12030.54255",
          "TND": "9556.888198965",
          "TOP": "7745.1330485",
          "TRY": "28482.117546845",
          "TTD": "23266.798518805",
          "TWD": "94780.792337495",
          "TZS": "7945042.277625",
          "UAH": "92209.909952125",
          "UGX": "12106899.70435383",
          "UYU": "145709.94860479",
          "UZS": "36484423.578943125",
          "VES": "14187815739.37725",
          "VND": "78056828.05485703",
          "VUV": "381767.376349815",
          "WST": "8776.013444835",
          "XAF": "1899375.939697575",
          "XAG": "142.51603492555",
          "XAU": "1.89071458315",
          "XCD": "9263.00363775",
          "XDR": "2413.727853615",
          "XOF": "1899375.939697575",
          "XPD": "1.38015343835",
          "XPF": "345534.60061641",
          "XPT": "3.40539759275",
          "YER": "859789.56755491",
          "ZAR": "49915.13234055",
          "ZMW": "54538.915418165",
          "JEP": "2486.898230355",
          "GGP": "2486.898230355",
          "IMP": "2486.898230355",
          "GBX": "93198.28868885765363542",
          "CNH": "22124.493362425",
          "MTL": "1229.736563221868163345",
          "TMM": "250654.6996133597567295",
          "ZWL": "1103656.61",
          "SGD": "4604.13319145",
          "USD": "3427.505",
          "BTC": "0.07151",
          "BCH": "5.2913193157959740321215",
          "BSV": "20.64902633108011005143",
          "ETH": "1.0",
          "ETH2": "0.999999999999999873543",
          "ETC": "53.139200471314175111885",
          "LTC": "19.6988706572027940938",
          "ZRX": "3193.8702009316491944025",
          "USDC": "3427.04",
          "BAT": "4172.229639519359",
          "MANA": "3530.1221199034741873325",
          "KNC": "1808.375761732661420953",
          "LINK": "127.88140789757212",
          "DNT": "17816.65120219985035631",
          "MKR": "0.9701734855893499751535",
          "CVC": "9850.65254191011853649",
          "OMG": "533.00754218178984402565",
          "DAI": "3424.53",
          "ZEC": "23.30130187973758547297",
          "XRP": "2995.1565745417268204365",
          "REP": "121.1346527655062563312",
          "XLM": "9978.761499941772178812",
          "EOS": "682.0905472636815596405",
          "XTZ": "624.6193517818254701851",
          "ALGO": "3032.2510726766044790775",
          "DASH": "15.111156668628578459445",
          "ATOM": "136.59479924280163852005",
          "OXT": "8261.038804531212781132",
          "COMP": "7.74384898669257407439",
          "ENJ": "1634.870021464345623079",
          "REPV2": "121.1346527655062563312",
          "BAND": "359.892163759883205432",
          "NMR": "76.71829709131199107895",
          "CGLD": "591.249859842506133436",
          "UMA": "257.8622479687029582147",
          "LRC": "6282.083944281525437294",
          "YFI": "0.09090352133603979484449",
          "UNI": "119.679423723901440450325",
          "BAL": "122.93935646227856914597",
          "REN": "4737.0672379241236298325",
          "WBTC": "0.07148196868666803103543",
          "NU": "10484.873049862342001272",
          "FIL": "46.197926319301001305585",
          "AAVE": "9.07054505229284015221",
          "BNT": "788.66645957730755054555",
          "GRT": "3828.758936550491410423",
          "SNX": "290.34349851757727904255",
          "STORJ": "2270.2467295909921703655",
          "SUSHI": "279.56388034665923",
          "MATIC": "2425.521902200835037312",
          "SKL": "8296.0304973980389747585",
          "ADA": "1212.856276531231",
          "ANKR": "33178.50055660423345061",
          "CRV": "1457.613387484318407246",
          "ICP": "51.280016158230974076405",
          "NKN": "7694.477494668312653272",
          "OGN": "2905.8965663416699959695",
          "1INCH": "1082.0852407261247286968",
          "USDT": "3426.485",
          "FORTH": "185.69211182143246975135",
          "CTSI": "4248.685757284458831096",
          "TRB": "64.3898704689980441989",
          "POLY": "9629.175445989604992958",
          "MIR": "866.8449671219019150728",
          "RLC": "732.7642971672901504375",
          "DOT": "118.465566404562344821565",
          "SOL": "26.9418755919932993177",
          "DOGE": "12291.572530034070328895",
          "MLN": "30.62364025428082571395",
          "GTC": "269.0138136723962119307",
          "AMP": "64197.50889679715820565",
          "CHZ": "9176.720214190093822875",
          "KEEP": "8288.006287026961875378",
          "LPT": "163.8778388716232371899",
          "QNT": "18.257144379044929286735",
          "BOND": "121.2632230673978443034",
          "RLY": "5557.365220916092352977",
          "CLV": "1898.894736842105405575",
          "FARM": "13.290311948661277587931",
          "MASK": "280.59803520261972415825",
          "FET": "5107.2939949336905358905",
          "PAX": "3410.4527363184084837035",
          "ACH": "34045.75186121472077849",
          "PLA": "2664.20909444228541398",
          "RAI": "1134.822699731814755685",
          "TRIBE": "4382.158153806814295386",
          "ORN": "399.0110593713620538418",
          "IOTX": "45911.25845556225541432",
          "UST": "3422.371442835745977274",
          "QUICK": "5.754226475279107393485",
          "AXS": "47.00041138155639329417",
          "REQ": "14235.8939214586830373475",
          "WLUNA": "100.30743342112964434949",
          "TRU": "6219.3884957358008827775",
          "COTI": "9887.509014856483707153"
        }
      }
    };
    axiosMock
      .onGet('/exchange-rates', {
        params: {
          currency: 'ETH'
        },
      })
      .replyOnce(200, ethToFiatRateStub);

    const ethToFiatRate = await croMarketPriceApi.getAssetPrice('ETH', 'SGD');
    expect(ethToFiatRate.assetSymbol).to.equal('ETH');
    expect(ethToFiatRate.currency).to.equal('SGD');
    expect(ethToFiatRate.dailyChange).to.deep.equal('');
    expect(ethToFiatRate.price).to.deep.equal('4604.13319145');

  });
  it('should return the `CRO` fiat rate ', async () => {
    const croToFiatRateStub = {
      "data": {
        "currency": "CRO",
        "rates": {
          "AED": "12589.911366",
          "AFN": "294527.77365831",
          "ALL": "353083.978571845",
          "AMD": "1688567.25495509",
          "ANG": "6147.57982301",
          "AOA": "2175159.795595",
          "ARS": "334658.143557475",
          "AUD": "4680.240939975",
          "AWG": "6171.2227525",
          "AZN": "5829.517641525",
          "BAM": "5660.47652243",
          "BBD": "6855.01",
          "BDT": "291880.95832717",
          "BGN": "5671.80099895",
          "BHD": "1292.10768991",
          "BIF": "6797514.0834757",
          "BMD": "3427.505",
          "BND": "4601.552280185",
          "BOB": "23648.45462806",
          "BRL": "17741.73929142",
          "BSD": "3427.505",
          "BTN": "249876.997659835",
          "BWP": "37882.927450625",
          "BYN": "8621.69003221",
          "BYR": "86216900.32210000685501",
          "BZD": "6903.13902521",
          "CAD": "4313.285399665",
          "CDF": "6801374.403524585",
          "CHF": "3124.407305345",
          "CLF": "96.94355142",
          "CLP": "2675030.5523",
          "CNY": "22145.795306",
          "COP": "13077691.86616289",
          "CRC": "2129666.75480034",
          "CUC": "3427.505",
          "CVE": "319568.80985785",
          "CZK": "73871.644263",
          "DJF": "609698.131472255",
          "DKK": "21530.88034397",
          "DOP": "194973.86185035",
          "DZD": "464112.54303138",
          "EGP": "53810.457498",
          "ERN": "51429.393767035",
          "ETB": "156450.731305805",
          "EUR": "2896.195",
          "FJD": "7179.76609875",
          "FKP": "2486.898230355",
          "GBP": "2486.76",
          "GEL": "10655.026525915",
          "GHS": "20702.4729505",
          "GIP": "2486.898230355",
          "GMD": "175419.7059",
          "GNF": "33527995.00667083",
          "GTQ": "26499.33675189",
          "GYD": "716083.89362893",
          "HKD": "26671.30153275",
          "HNL": "81769.95936496",
          "HRK": "21687.195137",
          "HTG": "334972.034465375",
          "HUF": "1009485.95811007",
          "IDR": "48923178.1185",
          "ILS": "10988.25198952",
          "INR": "250185.5862175",
          "IQD": "4996822.346757365",
          "ISK": "433133.80685",
          "JMD": "518657.394888205",
          "JOD": "2430.101045",
          "JPY": "376208.0900575",
          "KES": "376374.32405",
          "KGS": "290297.99941797",
          "KHR": "13950258.181808855",
          "KMF": "1436123.700421195",
          "KRW": "3967987.684201655",
          "KWD": "1030.7193036",
          "KYD": "2853.82977813",
          "KZT": "1460695.4186436",
          "LAK": "32823182.97736015",
          "LBP": "5178341.736525505",
          "LKR": "683212.643424275",
          "LRD": "589016.76167004",
          "LSL": "49812.756193705",
          "LYD": "15477.36496818",
          "MAD": "30619.58849746",
          "MDL": "60376.42600135",
          "MGA": "13421501.633155635",
          "MKD": "178273.072964955",
          "MMK": "5636942.214000955",
          "MNT": "9744827.11365786",
          "MOP": "27447.82335553",
          "MRO": "1223618.69546914",
          "MUR": "146011.716427505",
          "MVR": "52954.606071995",
          "MWK": "2782641.318453695",
          "MXN": "68948.82165665",
          "MYR": "14248.138285",
          "MZN": "218417.756125",
          "NAD": "51138.3746",
          "NGN": "1412132.06",
          "NIO": "120260.850797475",
          "NOK": "29725.27703785",
          "NPR": "399779.367555475",
          "NZD": "4856.01367889",
          "OMR": "1319.661402605",
          "PAB": "3427.505",
          "PEN": "13985.08413126",
          "PGK": "12024.520423715",
          "PHP": "170062.515585",
          "PKR": "571484.473781665",
          "PLN": "13114.38132609",
          "PYG": "23698451.68462506",
          "QAR": "12642.85946324",
          "RON": "14293.124288125",
          "RSD": "340294.771500115",
          "RUB": "251318.7193705",
          "RWF": "3455741.01240533",
          "SAR": "12855.15226793",
          "SBD": "27630.24202664",
          "SCR": "43862.429283445",
          "SEK": "29420.4690182",
          "SHP": "2486.898230355",
          "SLL": "35362768.228471795",
          "SOS": "1981274.20771221",
          "SRD": "72988.718975",
          "SSP": "446466.8013",
          "STD": "71113155.69141252",
          "SVC": "29966.08668414",
          "SZL": "49773.11024337",
          "THB": "110441.97782633",
          "TJS": "39013.880710445",
          "TMT": "12030.54255",
          "TND": "9556.888198965",
          "TOP": "7745.1330485",
          "TRY": "28482.117546845",
          "TTD": "23266.798518805",
          "TWD": "94780.792337495",
          "TZS": "7945042.277625",
          "UAH": "92209.909952125",
          "UGX": "12106899.70435383",
          "UYU": "145709.94860479",
          "UZS": "36484423.578943125",
          "VES": "14187815739.37725",
          "VND": "78056828.05485703",
          "VUV": "381767.376349815",
          "WST": "8776.013444835",
          "XAF": "1899375.939697575",
          "XAG": "142.51603492555",
          "XAU": "1.89071458315",
          "XCD": "9263.00363775",
          "XDR": "2413.727853615",
          "XOF": "1899375.939697575",
          "XPD": "1.38015343835",
          "XPF": "345534.60061641",
          "XPT": "3.40539759275",
          "YER": "859789.56755491",
          "ZAR": "49915.13234055",
          "ZMW": "54538.915418165",
          "JEP": "2486.898230355",
          "GGP": "2486.898230355",
          "IMP": "2486.898230355",
          "GBX": "93198.28868885765363542",
          "CNH": "22124.493362425",
          "MTL": "1229.736563221868163345",
          "TMM": "250654.6996133597567295",
          "ZWL": "1103656.61",
          "SGD": "4604.13319145",
          "USD": "3427.505",
          "BTC": "0.07151",
          "BCH": "5.2913193157959740321215",
          "BSV": "20.64902633108011005143",
          "ETH": "1.0",
          "ETH2": "0.999999999999999873543",
          "ETC": "53.139200471314175111885",
          "LTC": "19.6988706572027940938",
          "ZRX": "3193.8702009316491944025",
          "USDC": "3427.04",
          "BAT": "4172.229639519359",
          "MANA": "3530.1221199034741873325",
          "KNC": "1808.375761732661420953",
          "LINK": "127.88140789757212",
          "DNT": "17816.65120219985035631",
          "MKR": "0.9701734855893499751535",
          "CVC": "9850.65254191011853649",
          "OMG": "533.00754218178984402565",
          "DAI": "3424.53",
          "ZEC": "23.30130187973758547297",
          "XRP": "2995.1565745417268204365",
          "REP": "121.1346527655062563312",
          "XLM": "9978.761499941772178812",
          "EOS": "682.0905472636815596405",
          "XTZ": "624.6193517818254701851",
          "ALGO": "3032.2510726766044790775",
          "DASH": "15.111156668628578459445",
          "ATOM": "136.59479924280163852005",
          "OXT": "8261.038804531212781132",
          "COMP": "7.74384898669257407439",
          "ENJ": "1634.870021464345623079",
          "REPV2": "121.1346527655062563312",
          "BAND": "359.892163759883205432",
          "NMR": "76.71829709131199107895",
          "CGLD": "591.249859842506133436",
          "UMA": "257.8622479687029582147",
          "LRC": "6282.083944281525437294",
          "YFI": "0.09090352133603979484449",
          "UNI": "119.679423723901440450325",
          "BAL": "122.93935646227856914597",
          "REN": "4737.0672379241236298325",
          "WBTC": "0.07148196868666803103543",
          "NU": "10484.873049862342001272",
          "FIL": "46.197926319301001305585",
          "AAVE": "9.07054505229284015221",
          "BNT": "788.66645957730755054555",
          "GRT": "3828.758936550491410423",
          "SNX": "290.34349851757727904255",
          "STORJ": "2270.2467295909921703655",
          "SUSHI": "279.56388034665923",
          "MATIC": "2425.521902200835037312",
          "SKL": "8296.0304973980389747585",
          "ADA": "1212.856276531231",
          "ANKR": "33178.50055660423345061",
          "CRV": "1457.613387484318407246",
          "ICP": "51.280016158230974076405",
          "NKN": "7694.477494668312653272",
          "OGN": "2905.8965663416699959695",
          "1INCH": "1082.0852407261247286968",
          "USDT": "3426.485",
          "FORTH": "185.69211182143246975135",
          "CTSI": "4248.685757284458831096",
          "TRB": "64.3898704689980441989",
          "POLY": "9629.175445989604992958",
          "MIR": "866.8449671219019150728",
          "RLC": "732.7642971672901504375",
          "DOT": "118.465566404562344821565",
          "SOL": "26.9418755919932993177",
          "DOGE": "12291.572530034070328895",
          "MLN": "30.62364025428082571395",
          "GTC": "269.0138136723962119307",
          "AMP": "64197.50889679715820565",
          "CHZ": "9176.720214190093822875",
          "KEEP": "8288.006287026961875378",
          "LPT": "163.8778388716232371899",
          "QNT": "18.257144379044929286735",
          "BOND": "121.2632230673978443034",
          "RLY": "5557.365220916092352977",
          "CLV": "1898.894736842105405575",
          "FARM": "13.290311948661277587931",
          "MASK": "280.59803520261972415825",
          "FET": "5107.2939949336905358905",
          "PAX": "3410.4527363184084837035",
          "ACH": "34045.75186121472077849",
          "PLA": "2664.20909444228541398",
          "RAI": "1134.822699731814755685",
          "TRIBE": "4382.158153806814295386",
          "ORN": "399.0110593713620538418",
          "IOTX": "45911.25845556225541432",
          "UST": "3422.371442835745977274",
          "QUICK": "5.754226475279107393485",
          "AXS": "47.00041138155639329417",
          "REQ": "14235.8939214586830373475",
          "WLUNA": "100.30743342112964434949",
          "TRU": "6219.3884957358008827775",
          "COTI": "9887.509014856483707153"
        }
      }
    };
    axiosMock
      .onGet('/exchange-rates', {
        params: {
          currency: 'CRO'
        },
      })
      .replyOnce(200, croToFiatRateStub);

    const croToFiatRate = await croMarketPriceApi.getAssetPrice('CRO', 'SGD');
    expect(croToFiatRate.assetSymbol).to.equal('CRO');
    expect(croToFiatRate.currency).to.equal('SGD');
    expect(croToFiatRate.dailyChange).to.deep.equal('');
    expect(croToFiatRate.price).to.deep.equal('4604.13319145');

  });
  it('should throw on legacy `CRO` and `USD` rate ', async () => {
    const croToFiatRateStub = { "ok": true, "coin": { "id": "CRO", "uid": "crypto-com-coin", "name": "Crypto.com Coin", "symbol": "CRO", "description": "Crypto.com Coin (CRO) is the native token of the Crypto.com Chain. The Crypto.com Chain was created to build a network of cryptocurrency projects, and develop merchants’ ability to accept crypto as a form of payment. The Crypto.com Chain is a high performing native blockchain solution, which will make the transaction flows between crypto users and merchants accepting crypto seamless, cost-efficient and secure.\r\n\r\nBusinesses can use Crypto.com pay Checkout and/or Invoice to enable customers to complete checkout and pay for goods and services with cryptocurrencies using the Crypto.com Wallet App. Businesses receive all their payments instantly in CRO or stable coins, or in fiat.", "url": "https://crypto.com/", "image_url": "https://s3-ap-southeast-1.amazonaws.com/monaco-cointrack-production/uploads/coin/colorful_logo/5c1248c15568a4017c20aa87/cro.png", "icon_url": "https://s3-ap-southeast-1.amazonaws.com/monaco-cointrack-production/uploads/coin/gray_logo/5c1248c15568a4017c20aa87/cro.png", "rank": 39, "price_crypto": { "currency": "BTC", "amount": "0.0000032669" }, "price_native": { "currency": "USD", "amount": "0.1567" }, "percent_change_crypto_24h": "0.0", "percent_change_native_24h": "0.77", "market_cap_crypto": { "currency": "BTC", "amount": "82043" }, "market_cap_native": { "currency": "USD", "amount": "3937174022.97" }, "volume_crypto_24h": { "currency": "BTC", "amount": "821" }, "volume_native_24h": { "currency": "USD", "amount": "39402767.85" }, "available_supply": "25263013692.0", "total_supply": "30263013692.0", "max_supply": "30263013692.0", "volume_btc_24h": "821", "market_cap_btc": "82043", "price_btc": "0.0000032669", "percent_change_btc_24h": "0.0", "price_usd": "0.1567", "volume_usd_24h": "39402767.85", "market_cap_usd": "3937174022.97", "percent_change_usd_24h": "0.77", "price": "0.1567", "percent": "0.77", "cap": "3937174022.96982", "volume": "39402767.85106307", "markets": [{ "rank": null, "exchange": "Bitcoin.com Exchange", "pair": "CRO/BTC", "url": null, "percentage": "19.71935735688201", "volume_native": { "currency": "USD", "amount": "7812922.61" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1564" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 7812922.61343486, "volume_btc": null, "price_usd": "0.1564", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "CRO/USDT", "url": null, "percentage": "10.80256042941858", "volume_native": { "currency": "USD", "amount": "4280036.47" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 4280036.47048598, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "OKEx", "pair": "CRO/USDT", "url": null, "percentage": "9.653965732725775", "volume_native": { "currency": "USD", "amount": "3824956.66" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 3824956.6564204, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "BitMart", "pair": "CRO/USDT", "url": null, "percentage": "8.805805542464867", "volume_native": { "currency": "USD", "amount": "3488910.72" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1563" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 3488910.71889942, "volume_btc": null, "price_usd": "0.1563", "price_btc": null }, { "rank": null, "exchange": "Upbit", "pair": "CRO/KRW", "url": null, "percentage": "8.735347885083556", "volume_native": { "currency": "USD", "amount": "3460994.99" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1582" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 3460994.99047676, "volume_btc": null, "price_usd": "0.1582", "price_btc": null }, { "rank": null, "exchange": "OKEx", "pair": "CRO/USDK", "url": null, "percentage": "7.647081579613381", "volume_native": { "currency": "USD", "amount": "3029817.63" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1563" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 3029817.63141948, "volume_btc": null, "price_usd": "0.1563", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "CRO/BTC", "url": null, "percentage": "7.612120877693737", "volume_native": { "currency": "USD", "amount": "3015966.00" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1562" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 3015966.00057441, "volume_btc": null, "price_usd": "0.1562", "price_btc": null }, { "rank": null, "exchange": "BiONE", "pair": "CRO/USDT", "url": null, "percentage": "4.5185231045790735", "volume_native": { "currency": "USD", "amount": "1790264.80" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1565" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 1790264.79941412, "volume_btc": null, "price_usd": "0.1565", "price_btc": null }, { "rank": null, "exchange": "FTX", "pair": "CRO/USD", "url": null, "percentage": "3.962247539770045", "volume_native": { "currency": "USD", "amount": "1569865.23" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1563" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 1569865.2265, "volume_btc": null, "price_usd": "0.1563", "price_btc": null }, { "rank": null, "exchange": "Huobi Global", "pair": "CRO/USDT", "url": null, "percentage": "2.041491359120642", "volume_native": { "currency": "USD", "amount": "808850.60" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1565" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 808850.59873612, "volume_btc": null, "price_usd": "0.1565", "price_btc": null }, { "rank": null, "exchange": "Binance JEX", "pair": "CRO/USDT", "url": null, "percentage": "2.0106492117439845", "volume_native": { "currency": "USD", "amount": "796630.76" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1565" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 796630.76284974, "volume_btc": null, "price_usd": "0.1565", "price_btc": null }, { "rank": null, "exchange": "OKEx", "pair": "CRO/BTC", "url": null, "percentage": "1.9381961435277348", "volume_native": { "currency": "USD", "amount": "767924.44" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1564" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 767924.44119662, "volume_btc": null, "price_usd": "0.1564", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "ATOM/CRO", "url": null, "percentage": "1.8979344342905935", "volume_native": { "currency": "USD", "amount": "751972.52" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 751972.52081395, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "Huobi Global", "pair": "CRO/BTC", "url": null, "percentage": "1.798583237323324", "volume_native": { "currency": "USD", "amount": "712609.01" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1564" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 712609.0061005, "volume_btc": null, "price_usd": "0.1564", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "EGLD/CRO", "url": null, "percentage": "1.6288018756173643", "volume_native": { "currency": "USD", "amount": "645340.66" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 645340.65570726, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "DragonEX", "pair": "CRO/USDT", "url": null, "percentage": "1.5512407102292747", "volume_native": { "currency": "USD", "amount": "614610.48" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1569" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 614610.47662394, "volume_btc": null, "price_usd": "0.1569", "price_btc": null }, { "rank": null, "exchange": "KuCoin", "pair": "CRO/USDT", "url": null, "percentage": "1.3750220916737632", "volume_native": { "currency": "USD", "amount": "544791.65" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1563" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 544791.64810415, "volume_btc": null, "price_usd": "0.1563", "price_btc": null }, { "rank": null, "exchange": "BHEX (BlueHelix Exchange)", "pair": "CRO/USDT", "url": null, "percentage": "1.325936300372409", "volume_native": { "currency": "USD", "amount": "525343.58" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1571" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 525343.57573972, "volume_btc": null, "price_usd": "0.1571", "price_btc": null }, { "rank": null, "exchange": "MEXC", "pair": "CRO/USDT", "url": null, "percentage": "1.2069461518077083", "volume_native": { "currency": "USD", "amount": "478199.00" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1563" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 478198.99563642, "volume_btc": null, "price_usd": "0.1563", "price_btc": null }, { "rank": null, "exchange": "DigiFinex", "pair": "CRO/USDT", "url": null, "percentage": "0.9508465926549192", "volume_native": { "currency": "USD", "amount": "376730.88" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1562" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 376730.87977527, "volume_btc": null, "price_usd": "0.1562", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "CRO/USDC", "url": null, "percentage": "0.9221960645540626", "volume_native": { "currency": "USD", "amount": "365379.38" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1563" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 365379.37603025, "volume_btc": null, "price_usd": "0.1563", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "ADA/CRO", "url": null, "percentage": "0.8892553691996208", "volume_native": { "currency": "USD", "amount": "352328.08" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 352328.0833852, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "ETH/CRO", "url": null, "percentage": "0.7176892657934969", "volume_native": { "currency": "USD", "amount": "284352.61" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 284352.60808236, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "OKEx", "pair": "CRO/USDT", "url": null, "percentage": "0.700214226966569", "volume_native": { "currency": "USD", "amount": "277428.90" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1567" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 277428.89735738, "volume_btc": null, "price_usd": "0.1567", "price_btc": null }, { "rank": null, "exchange": "Bibox", "pair": "CRO/USDT", "url": null, "percentage": "0.6829929893076686", "volume_native": { "currency": "USD", "amount": "270605.74" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1565" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 270605.7441125, "volume_btc": null, "price_usd": "0.1565", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "MANA/CRO", "url": null, "percentage": "0.6758296558955095", "volume_native": { "currency": "USD", "amount": "267767.59" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 267767.59028271, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "MKR/CRO", "url": null, "percentage": "0.597672783105816", "volume_native": { "currency": "USD", "amount": "236801.39" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 236801.38850632, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "BKEX", "pair": "CRO/USDT", "url": null, "percentage": "0.5805999439624762", "volume_native": { "currency": "USD", "amount": "230037.03" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1565" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 230037.03160541, "volume_btc": null, "price_usd": "0.1565", "price_btc": null }, { "rank": null, "exchange": "Crypto.com Exchange", "pair": "ENJ/CRO", "url": null, "percentage": "0.5510408725017507", "volume_native": { "currency": "USD", "amount": "218325.56" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1566" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 218325.55776435, "volume_btc": null, "price_usd": "0.1566", "price_btc": null }, { "rank": null, "exchange": "Bittrex", "pair": "CRO/BTC", "url": null, "percentage": "0.5553668532844337", "volume_native": { "currency": "USD", "amount": "220039.54" }, "volume_crypto": { "currency": "BTC", "amount": null }, "price_native": { "currency": "USD", "amount": "0.1569" }, "price_crypto": { "currency": "BTC", "amount": null }, "volume_usd": 220039.53619025, "volume_btc": null, "price_usd": "0.1569", "price_btc": null }] } };
    axiosMock
      .onGet()
      .replyOnce(200, croToFiatRateStub);

    const croToFiatRate = await croMarketPriceApi.getAssetPrice('CRO', 'USD');
    expect(croToFiatRate.assetSymbol).to.equal('CRO');
    expect(croToFiatRate.currency).to.equal('USD');
    expect(parseFloat(croToFiatRate.dailyChange)).to.be.greaterThan(0);
    expect(parseFloat(croToFiatRate.price)).to.be.greaterThan(0.0);

  });
  
});
